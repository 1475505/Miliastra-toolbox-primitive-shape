# Shaper 使用指南

Shaper 是一个用于将图片中的轮廓自动拟合为几何图元（圆/椭圆、矩形）的工具。

## 1. 快速开始

1.  **上传图片**: 在左侧面板点击或拖拽上传图片。建议使用背景清晰、轮廓分明的图片。
2.  **点击开始**: 直接点击底部的「开始处理」按钮，使用默认参数进行拟合。
3.  **查看结果**: 处理完成后会自动跳转到结果页，您可以查看拟合出的图元列表、导出 JSON 数据或 PNG 图片。

## 2. 参数说明

在上传页面，您可以调整以下参数来优化拟合结果：

*   **图元像素大小 (Primitive Size)**:
    *   决定了拟合的粒度。数值越小，生成的图元越密集、越小；数值越大，生成的图元越大。
    *   *提示*: 如果您的图片线条很细，建议调小此值。
*   **精度 (Precision)**:
    *   控制图元与轮廓的贴合程度。
    *   高精度要求图元必须紧贴轮廓，可能会减少生成的图元数量；低精度允许一定的偏差，可能会生成更多图元。
*   **间距 (Spacing)**:
    *   控制相邻图元之间的重叠程度。
    *   数值越小，图元越紧密（允许更多重叠）；数值越大，图元越稀疏。

## 3. 图元定义与颜色

您可以自定义希望使用的图元类型及其显示颜色：

1.  在「图元定义」区域点击 `+ 添加图元`。
2.  **形状**: 选择 `圆形` (实际为椭圆) 或 `矩形`。
3.  **颜色**: 点击颜色块选择颜色。
    *   **重要**: 您选择的颜色将直接应用于结果中对应的图元类型。例如，如果您添加了一个红色圆形，那么所有识别出的圆形（椭圆）都将显示为红色。
4.  **宽/高 (W/H)**: 目前主要作为预留参数，算法会自动根据图像特征调整图元长宽比。

*注意*: 如果您只定义了圆形，算法将只尝试拟合圆形；如果同时定义了圆形和矩形，算法将根据轮廓特征自动选择最合适的形状。

## 4. 原点设置 (Origin)

您可以控制坐标系的原点位置，这对于导出数据的坐标值非常重要：

*   **图像中心 (默认)**: 以图片的几何中心 (Width/2, Height/2) 为原点 (0,0)。
*   **左上角**: 以图片左上角为原点 (0,0)，X轴向右，Y轴向下。
*   **自定义坐标**: 手动输入原点在图片像素坐标系中的位置 (X, Y)。

在结果页面，您还可以通过**右键点击画布**临时更改显示的原点位置。

## 5. 结果交互

*   **缩放/漫游**: 暂不支持鼠标滚轮缩放，但会自动适配窗口大小。
*   **高亮**: 鼠标悬停在图元上可高亮显示，右侧面板会显示该图元的详细参数。
*   **导出**:
    *   **JSON**: 导出包含所有图元坐标、尺寸、角度的结构化数据。
    *   **PNG**: 导出当前视图的渲染图片。

## 常见问题

**Q: 为什么我设置了颜色和原点，结果里好像没生效？**
A: 请确保您使用的是最新版本的 Shaper。在旧版本中，颜色和自定义原点功能尚未实装。现在您可以直接在上传页面设置「原点类型」以及为图元指定颜色，处理结果将严格遵循您的设置。

**Q: 这里的 W 和 H 输入框有什么用？**
A: 目前算法采用自动拟合策略，W 和 H 输入框主要用于标记意图，实际生成的图元尺寸主要由「图元像素大小」滑块和图像轮廓特征决定。

**Q: 如何让结果坐标符合我的 CNC/加工设备坐标系？**
A: 使用「自定义原点」功能，输入您设备对应的零点在图片中的像素位置，导出的 JSON 数据中的 `relative_position` 即为相对于该原点的坐标。
